<!DOCTYPE html>
<html lang="en">

<head>
    <title>Primera Tech Labs ‚Äì Network Configuration</title>
    <meta charset="utf-8">
    <meta http-equiv="Content-Security-Policy" content="referrer no-referrer">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <style>
        :root {
            --bg-main: #f8f9fa;
            --bg-card: #ffffff;
            --bg-card-soft: #f0f2f5;
            --accent: #4910bc;
            --accent-soft: rgba(73, 16, 188, 0.12);
            --accent-2: #6b2fe0;
            --text-main: #1a1a2e;
            --text-sub: #5c5c6e;
            --border-soft: rgba(0, 0, 0, 0.10);
            --danger: #dc3545;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", sans-serif;
            background:
                radial-gradient(circle at top, rgba(73, 16, 188, 0.08) 0, #f8f9fa 55%, #ffffff 100%),
                #ffffff;
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .page {
            width: 100%;
            max-width: 1100px;
            padding: 20px 14px;
            display: grid;
            grid-template-columns: minmax(0, 3fr) minmax(0, 2.4fr);
            gap: 22px;
            align-items: stretch;
        }

        .card {
            position: relative;
            background: #ffffff;
            border-radius: 24px;
            padding: 24px 22px 20px;
            box-shadow:
                0 4px 6px rgba(0, 0, 0, 0.04),
                0 10px 20px rgba(73, 16, 188, 0.08),
                0 25px 50px rgba(73, 16, 188, 0.12);
            border: 1px solid rgba(73, 16, 188, 0.12);
            overflow: hidden;
        }

        .card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4910bc, #6b2fe0, #4910bc);
            border-radius: 24px 24px 0 0;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 14px;
        }

        .brand {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .brand-logo {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 20px;
            color: #4910bc;
            box-shadow:
                0 2px 8px rgba(73, 16, 188, 0.15),
                0 4px 16px rgba(73, 16, 188, 0.1);
            border: 2px solid rgba(73, 16, 188, 0.15);
            flex-shrink: 0;
            overflow: hidden;
        }

        .brand-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 4px;
        }

        .brand-text-main {
            font-size: 18px;
            font-weight: 800;
            letter-spacing: 0.06em;
            color: #4910bc;
            text-shadow: 0 1px 2px rgba(73, 16, 188, 0.15);
        }

        .brand-text-sub {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: #6b7280;
            font-weight: 500;
        }

        .language-switch {
            display: flex;
            align-items: center;
            gap: 6px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 999px;
            padding: 4px 10px;
            border: 1px solid rgba(73, 16, 188, 0.2);
            box-shadow: 0 4px 14px rgba(73, 16, 188, 0.12);
        }

        .language-switch span {
            font-size: 11px;
            color: var(--text-sub);
            text-transform: uppercase;
            letter-spacing: 0.16em;
        }

        .language-switch select {
            padding: 4px 6px;
            border-radius: 999px;
            border: 1px solid rgba(73, 16, 188, 0.2);
            background: #ffffff;
            color: var(--text-main);
            font-size: 11px;
            outline: none;
        }

        .tabs {
            display: inline-flex;
            padding: 4px;
            border-radius: 999px;
            background: rgba(73, 16, 188, 0.08);
            border: 1px solid rgba(73, 16, 188, 0.15);
            margin-bottom: 10px;
        }

        .tab {
            padding: 8px 18px;
            border-radius: 999px;
            cursor: pointer;
            font-size: 13px;
            border: none;
            background: transparent;
            color: var(--text-sub);
            transition: background 0.15s ease, color 0.15s ease, transform 0.08s ease;
        }

        .tab.active {
            background: linear-gradient(135deg, var(--accent), var(--accent-2));
            color: #ffffff;
            font-weight: 600;
            box-shadow: 0 4px 18px rgba(73, 16, 188, 0.4);
            transform: translateY(-0.5px);
        }

        .tab-content {
            display: none;
            background: radial-gradient(circle at top left, rgba(73, 16, 188, 0.04), transparent 65%),
                radial-gradient(circle at bottom right, rgba(107, 47, 224, 0.06), transparent 55%),
                var(--bg-card-soft);
            border-radius: 18px;
            padding: 18px 18px 16px;
            border: 1px solid rgba(73, 16, 188, 0.1);
            margin-top: 8px;
        }

        .tab-content.active {
            display: block;
        }

        h3 {
            margin: 0 0 10px;
            font-size: 15px;
        }

        p {
            margin: 8px 0;
            font-size: 13px;
        }

        label {
            display: block;
            margin-bottom: 4px;
            font-size: 13px;
            font-weight: 600;
        }

        input[type="text"],
        input[type="password"],
        select {
            width: 100%;
            padding: 8px 10px;
            font-size: 13px;
            border-radius: 10px;
            border: 1px solid var(--border-soft);
            background: #ffffff;
            color: var(--text-main);
            outline: none;
            transition: border-color 0.16s ease, box-shadow 0.16s ease, background 0.16s ease, transform 0.06s ease;
        }

        input[type="text"]::placeholder,
        input[type="password"]::placeholder {
            color: #9ca3af;
        }

        input[type="text"]:focus,
        input[type="password"]:focus,
        select:focus {
            border-color: var(--accent);
            box-shadow:
                0 0 0 2px rgba(73, 16, 188, 0.2),
                0 4px 18px rgba(73, 16, 188, 0.15);
            background: #ffffff;
            transform: translateY(-0.3px);
        }

        input[type="submit"] {
            width: auto;
            min-width: 120px;
            padding: 9px 20px;
            border-radius: 999px;
            border: none;
            background: linear-gradient(135deg, var(--accent), var(--accent-2));
            color: #ffffff;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(73, 16, 188, 0.35);
            transition: background 0.16s ease, box-shadow 0.16s ease, transform 0.06s ease, opacity 0.1s ease;
        }

        input[type="submit"]:hover {
            box-shadow: 0 12px 30px rgba(73, 16, 188, 0.45);
            transform: translateY(-0.5px);
        }

        input[type="submit"]:active {
            box-shadow: 0 6px 18px rgba(73, 16, 188, 0.4);
            transform: translateY(0.2px) scale(0.99);
        }

        input[type="submit"]:disabled {
            background: linear-gradient(135deg, #9ca3af, #6b7280);
            cursor: not-allowed;
            box-shadow: none;
            opacity: 0.7;
        }

        #remember_bssid,
        #sleep_mode {
            width: auto;
        }

        #saved_list_container {
            margin-bottom: 12px;
            padding: 10px 12px;
            border-radius: 12px;
            background: rgba(73, 16, 188, 0.04);
            border: 1px solid rgba(73, 16, 188, 0.1);
        }

        #saved_list {
            padding-left: 16px;
            margin: 0;
            list-style: none;
        }

        #saved_list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            margin: 4px 0;
            gap: 6px;
        }

        #saved_list button {
            border-radius: 999px;
            border: 1px solid rgba(73, 16, 188, 0.2);
            background: #ffffff;
            color: var(--text-main);
            font-size: 11px;
            padding: 3px 6px;
            cursor: pointer;
        }

        #saved_list button:hover {
            background: rgba(73, 16, 188, 0.08);
        }

        #ap_list {
            margin-top: 12px;
            font-size: 13px;
        }

        #ap_list p {
            margin-top: 0;
        }

        #ap_list .scanning {
            font-style: italic;
            color: var(--text-sub);
        }

        #ap_list a {
            display: block;
            margin-top: 5px;
            color: var(--accent);
            text-decoration: none;
            font-size: 13px;
        }

        #ap_list a:hover {
            text-decoration: underline;
        }

        .error {
            color: var(--danger);
            font-size: 13px;
        }

        .toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(73, 16, 188, 0.95);
            color: white;
            padding: 14px 26px;
            border-radius: 10px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.25s ease-in-out;
            min-width: 200px;
            text-align: center;
            font-size: 14px;
            box-shadow: 0 8px 32px rgba(73, 16, 188, 0.4);
        }

        .toast.show {
            opacity: 1;
        }

        .loading-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background-color: rgba(255, 255, 255, 0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 18px;
        }

        .loading-animation {
            position: relative;
            width: 160px;
            height: 160px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .loading-spinner {
            position: absolute;
            inset: 0;
            border-radius: 50%;
            border: 4px solid rgba(73, 16, 188, 0.15);
            border-top-color: var(--accent);
            animation: spin 1s linear infinite;
        }

        .loading-spinner::before {
            content: '';
            position: absolute;
            inset: 6px;
            border-radius: 50%;
            border: 3px solid rgba(107, 47, 224, 0.1);
            border-top-color: var(--accent-2);
            animation: spin 1.5s linear infinite reverse;
        }

        .loading-logo {
            width: 80px;
            height: 80px;
            animation: pulse 2s ease-in-out infinite;
            filter: drop-shadow(0 4px 12px rgba(73, 16, 188, 0.3));
        }

        .loading-logo svg {
            width: 100%;
            height: 100%;
        }

        .loading-text {
            color: #1a1a2e;
            font-size: 16px;
            font-weight: 600;
            animation: fadeInOut 2s ease-in-out infinite;
        }

        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.05);
                opacity: 0.85;
            }
        }

        @keyframes fadeInOut {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.6;
            }
        }

        @keyframes dots {
            0% {
                content: '';
            }

            25% {
                content: '.';
            }

            50% {
                content: '..';
            }

            75% {
                content: '...';
            }
        }

        .guide-card {
            position: relative;
            background:
                radial-gradient(circle at top right, rgba(107, 47, 224, 0.08), transparent 65%),
                radial-gradient(circle at bottom left, rgba(73, 16, 188, 0.06), transparent 55%),
                #ffffff;
            border-radius: 22px;
            padding: 20px 20px 18px;
            box-shadow:
                0 20px 52px rgba(73, 16, 188, 0.12),
                0 0 0 1px rgba(73, 16, 188, 0.08);
            border: 1px solid rgba(73, 16, 188, 0.15);
            color: var(--text-main);
        }

        .guide-title {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 0 10px;
            font-size: 15px;
        }

        .guide-title span {
            font-size: 18px;
        }

        .guide-intro {
            font-size: 13px;
            color: var(--text-sub);
            margin: 0 0 10px;
        }

        .steps {
            list-style: none;
            padding: 0;
            margin: 0 0 10px;
            counter-reset: step;
        }

        .steps li {
            position: relative;
            padding-left: 24px;
            margin-bottom: 8px;
            font-size: 13px;
            color: var(--text-main);
        }

        .steps li::before {
            counter-increment: step;
            content: counter(step);
            position: absolute;
            left: 0;
            top: 1px;
            width: 17px;
            height: 17px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--accent-2));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
            color: #ffffff;
            box-shadow: 0 4px 14px rgba(73, 16, 188, 0.4);
        }

        .steps li span.tag {
            margin-left: 4px;
            font-size: 11px;
            border-radius: 999px;
            padding: 1px 7px;
            border: 1px solid rgba(73, 16, 188, 0.5);
            color: var(--accent);
            background: rgba(73, 16, 188, 0.08);
        }

        .guide-highlight {
            margin-top: 6px;
            padding: 8px 9px;
            border-radius: 14px;
            font-size: 12px;
            background: rgba(73, 16, 188, 0.04);
            border: 1px dashed rgba(73, 16, 188, 0.35);
            color: var(--text-sub);
        }

        .guide-highlight strong {
            color: var(--accent);
        }

        .guide-section-title {
            margin: 12px 0 4px;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--accent-soft);
        }

        .error-list {
            margin: 0;
            padding-left: 16px;
            font-size: 12px;
            color: var(--text-sub);
        }

        .error-list li+li {
            margin-top: 4px;
        }

        .help-links {
            margin-top: 10px;
            font-size: 12px;
        }

        .help-links a {
            color: var(--accent);
            text-decoration: none;
        }

        .help-links a:hover {
            text-decoration: underline;
        }

        .guide-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            padding: 3px 10px;
            border-radius: 999px;
            background: rgba(73, 16, 188, 0.08);
            border: 1px solid rgba(73, 16, 188, 0.2);
            margin-bottom: 6px;
        }

        .guide-badge span.dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background: #4910bc;
            box-shadow: 0 0 12px rgba(73, 16, 188, 0.6);
        }

        .guide-footer {
            margin-top: 10px;
            font-size: 11px;
            text-align: right;
            color: var(--text-sub);
        }

        .guide-footer span {
            color: var(--accent);
            font-weight: 600;
        }

        @media (max-width: 900px) {
            .page {
                grid-template-columns: minmax(0, 1fr);
                max-width: 500px;
                margin: 0 auto;
            }

            .card {
                width: 100%;
            }
        }

        @media (max-width: 520px) {
            body {
                padding: 0;
            }

            .page {
                padding: 16px;
                max-width: 100%;
            }

            .card,
            .guide-card {
                border-radius: 20px;
                padding: 18px 16px 16px;
            }

            .card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .brand-logo {
                width: 36px;
                height: 36px;
            }

            .brand-text-main {
                font-size: 16px;
            }

            .language-switch {
                margin-left: 0;
                margin-top: 4px;
            }

            .tabs {
                width: 100%;
                justify-content: center;
            }

            .tab {
                padding: 8px 16px;
                font-size: 12px;
            }

            .tab-content {
                padding: 14px 12px 12px;
            }

            input[type="text"],
            input[type="password"],
            select {
                padding: 10px 12px;
                font-size: 14px;
            }

            input[type="submit"] {
                width: 100%;
                padding: 12px 20px;
                font-size: 14px;
            }

            .loading-animation {
                width: 140px;
                height: 140px;
            }

            .loading-logo {
                width: 65px;
                height: 65px;
            }
        }

        @media (max-width: 380px) {
            .page {
                padding: 12px;
            }

            .card {
                padding: 14px 12px 12px;
            }

            .brand-text-main {
                font-size: 14px;
            }

            .brand-text-sub {
                font-size: 10px;
            }
        }
    </style>
</head>

<body>
    <div class="toast" id="toast"></div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-animation">
                <div class="loading-spinner"></div>
                <div class="loading-logo">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 375 375" preserveAspectRatio="xMidYMid meet">
                        <defs>
                            <clipPath id="l1">
                                <path
                                    d="M 17.59 146.84 C 15.87 153.6 14.74 161.29 14.74 168.83 C 14.74 176.38 15.71 183.63 17.43 190.32 C 17.48 190.46 17.48 190.61 17.54 190.75 C 24.42 215.87 42.59 234.38 64.69 234.73 L 175.31 234.73 L 175.31 102.86 L 64.77 102.86 C 42.48 103.22 24.31 121.43 17.59 146.84 Z" />
                            </clipPath>
                            <clipPath id="l2">
                                <path
                                    d="M 119.95 241.28 L 173.71 241.28 C 174.59 241.28 175.32 242 175.32 242.88 L 175.32 295.36 C 175.32 296.25 174.59 296.97 173.71 296.97 L 119.95 296.97 C 119.06 296.97 118.34 296.25 118.34 295.36 L 118.34 242.88 C 118.34 242 119.06 241.28 119.95 241.28 Z" />
                            </clipPath>
                        </defs>
                        <rect x="0" width="375" fill="#f4f4f4" y="0" height="375" />
                        <g clip-path="url(#l1)">
                            <rect fill="#4910bc" x="14" y="102" width="162" height="133" />
                        </g>
                        <g clip-path="url(#l2)">
                            <rect fill="#4910bc" x="118" y="241" width="58" height="56" />
                        </g>
                        <path fill="#000"
                            d="M 236.44 231.14 L 193.89 231.14 C 190.42 231.14 187.91 230.37 186.34 228.81 C 184.79 227.25 184.02 224.73 184.02 221.27 L 184.02 43.42 C 184.02 39.94 184.79 37.43 186.34 35.87 C 187.91 34.31 190.42 33.53 193.89 33.53 L 277.88 33.53 C 302.76 33.53 319.78 38.48 328.92 48.36 C 338.08 58.23 342.66 71.13 342.66 87.05 L 342.66 122.19 C 342.66 138.1 338.08 151.01 328.92 160.89 C 319.78 170.76 302.76 175.7 277.88 175.70 L 246.31 175.70 L 246.31 221.27 C 246.31 224.73 245.54 227.25 243.98 228.81 C 242.43 230.37 239.92 231.14 236.44 231.14 Z M 245.77 84.86 L 245.77 126.30 L 270.47 126.30 C 275.77 126.30 279.25 124.93 280.89 122.19 C 282.55 119.44 283.38 116.32 283.38 112.85 L 283.38 98.31 C 283.38 94.83 282.55 91.73 280.89 88.98 C 279.25 86.23 275.77 84.86 270.47 84.86 Z" />
                    </svg>
                </div>
            </div>
            <div class="loading-text"><span data-lang="connecting">Connecting</span><span class="loading-dots"></span>
            </div>
        </div>
    </div>

    <div class="page">
        <div class="card">
            <div class="card-header">
                <div class="brand">
                    <div class="brand-logo"><img
                            src="data:image/png;base64,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"
                            alt="Primera"></div>
                    <div>
                        <div class="brand-text-main">PRIMERA TECH LABS</div>
                        <div class="brand-text-sub">Wi-Fi device setup</div>
                    </div>
                </div>

                <div class="language-switch">
                    <span>LANG</span>
                    <select id="language" onchange="changeLanguage()">
                        <option value="vi-VN">Ti·∫øng Vi·ªát</option>
                        <option value="en-US">English</option>
                    </select>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" onclick="switchTab('wifi')" data-lang="wifi_tab">Wi-Fi Config</div>
                <div class="tab" onclick="switchTab('advanced')" data-lang="advanced_tab" style="display:none;">Advanced
                </div>
            </div>

            <div id="wifi-tab" class="tab-content active">
                <div id="saved_list_container" style="display: none;">
                    <h3 data-lang="saved_wifi">Saved Wi-Fi</h3>
                    <ul id="saved_list">
                        <li><span>SSID</span></li>
                    </ul>
                </div>

                <div>
                    <h3 data-lang="new_wifi">New Wi-Fi</h3>
                    <p class="error" id="error"></p>
                    <form action="/submit" method="post" onsubmit="submitForm(event)">
                        <p>
                            <label for="ssid">SSID:</label>
                            <input type="text" id="ssid" name="ssid" required readonly>
                        </p>
                        <p>
                            <label for="password" data-lang="password">Password:</label>
                            <input type="password" id="password" name="password">
                        </p>
                        <p style="text-align:center;margin-top:12px;">
                            <input type="submit" value="Connect" id="button" data-lang-value="connect">
                        </p>
                    </form>
                    <p id="ap_list"></p>
                </div>
            </div>

            <div id="advanced-tab" class="tab-content">
                <form action="/advanced/submit" method="post" onsubmit="submitAdvancedForm(event)">
                    <div>
                        <h3 data-lang="advanced_tab">Advanced</h3>
                        <p class="error" id="advanced_error"></p>

                        <p>
                            <label for="weather_api_key" data-lang="weather_api_key">Custom WEATHER API Key:</label>
                        <div style="display:flex;align-items:center;gap:10px;">
                            <input type="text" id="weather_api_key" name="weather_api_key"
                                placeholder="Nh·∫≠p API KEY t·ª´ https://openweathermap.org/api" style="flex:1;">
                            <button type="button" onclick="clearWeatherApiKey()"
                                style="padding:5px 10px;border:1px solid rgba(255,255,255,0.25);border-radius:8px;background:rgba(0,0,0,0.4);color:#fff;cursor:pointer;">‚ùå</button>
                        </div>
                        </p>

                        <p>
                            <label for="weather_city" data-lang="weather_city">Custom WEATHER City:</label>
                        <div style="display:flex;align-items:center;gap:10px;">
                            <input type="text" id="weather_city" name="weather_city"
                                placeholder="ƒê·ªÉ tr·ªëng ho·∫∑c nh·∫≠p t√™n th√†nh ph·ªë" style="flex:1;">
                            <button type="button" onclick="clearWeatherCity()"
                                style="padding:5px 10px;border:1px solid rgba(255,255,255,0.25);border-radius:8px;background:rgba(0,0,0,0.4);color:#fff;cursor:pointer;">‚ùå</button>
                        </div>
                        </p>

                        <p>
                            <label for="music_url" data-lang="music_url">Custom MUSIC URL:</label>
                        <div style="display:flex;align-items:center;gap:10px;">
                            <input type="text" id="music_url" name="music_url" style="flex:1;">
                            <button type="button" onclick="clearMusicUrl()"
                                style="padding:5px 10px;border:1px solid rgba(255,255,255,0.25);border-radius:8px;background:rgba(0,0,0,0.4);color:#fff;cursor:pointer;">‚ùå</button>
                        </div>
                        </p>

                        <p>
                            <label for="ota_url" data-lang="ota_url">Custom OTA URL:</label>
                        <div style="display:flex;align-items:center;gap:10px;">
                            <input type="text" id="ota_url" name="ota_url" style="flex:1;">
                            <button type="button" onclick="clearOtaUrl()"
                                style="padding:5px 10px;border:1px solid rgba(255,255,255,0.25);border-radius:8px;background:rgba(0,0,0,0.4);color:#fff;cursor:pointer;">‚ùå</button>
                        </div>
                        </p>

                        <p style="display:flex;align-items:center;gap:10px;">
                            <label for="max_tx_power" data-lang="max_tx_power" style="white-space:nowrap;">Wi-Fi Max TX
                                Power:</label>
                            <select id="max_tx_power" name="max_tx_power">
                                <option value="8">2 dBm</option>
                                <option value="20">5 dBm</option>
                                <option value="28">7 dBm</option>
                                <option value="34">8 dBm</option>
                                <option value="44">11 dBm</option>
                                <option value="52">13 dBm</option>
                                <option value="56">14 dBm</option>
                                <option value="60">15 dBm</option>
                                <option value="66">16 dBm</option>
                                <option value="72">18 dBm</option>
                                <option value="80">20 dBm</option>
                            </select>
                        </p>

                        <p style="display:flex;align-items:center;gap:10px;">
                            <label for="remember_bssid" style="margin:0;">
                                <span data-lang="remember_bssid">Remember BSSID when connecting to Wi-Fi</span>
                            </label>
                            <input type="checkbox" id="remember_bssid" name="remember_bssid">
                        </p>

                        <p style="display:flex;align-items:center;gap:10px;">
                            <label for="sleep_mode" style="margin:0;">
                                <span data-lang="sleep_mode">Enable Sleep Mode</span>
                            </label>
                            <input type="checkbox" id="sleep_mode" name="sleep_mode">
                        </p>

                        <p style="text-align:center;margin-top:12px;">
                            <input type="submit" value="Save" id="advanced_button" data-lang-value="save">
                        </p>
                    </div>
                </form>
            </div>
        </div>

        <div class="guide-card" style="display:none;">
            <div class="guide-badge">
                <span class="dot"></span>
                Quick guide for Primera Tech Labs devices
            </div>
            <h3 class="guide-title">
                <span>üì∂</span>
                K·∫øt n·ªëi Wi-Fi cho thi·∫øt b·ªã ESP32
            </h3>
            <p class="guide-intro">
                D√πng trang n√†y khi thi·∫øt b·ªã Primera Tech Labs m·ªü ƒëi·ªÉm ph√°t Wi-Fi ri√™ng. Ch·ªâ c·∫ßn ch·ªçn m·∫°ng nh√† b·∫°n v√†
                nh·∫≠p
                m·∫≠t kh·∫©u, ph·∫ßn c√≤n l·∫°i thi·∫øt b·ªã s·∫Ω t·ª± x·ª≠ l√Ω.
            </p>
            <ol class="steps">
                <li>
                    K·∫øt n·ªëi ƒëi·ªán tho·∫°i/laptop v√†o Wi-Fi t·∫°m th·ªùi c·ªßa thi·∫øt b·ªã
                    (th∆∞·ªùng c√≥ ch·ªØ <strong>ESP32</strong> ho·∫∑c t√™n board) r·ªìi m·ªü trang c·∫•u h√¨nh.
                </li>
                <li>
                    Nh·∫•n v√†o m·∫°ng Wi-Fi trong m·ª•c
                    <strong data-lang="select_wifi">Select a 2.4G Wi-Fi from the list below:</strong>
                    ƒë·ªÉ ƒë·ªï t√™n SSID v√†o √¥ b√™n tr√™n.
                </li>
                <li>
                    Nh·∫≠p ƒë√∫ng m·∫≠t kh·∫©u Wi-Fi nh√† b·∫°n r·ªìi nh·∫•n n√∫t
                    <strong data-lang="connect">Connect</strong>
                    <span class="tag">T·ª± ƒë·ªông l∆∞u</span>
                </li>
                <li>
                    ƒê·ª£i thi·∫øt b·ªã b√°o k·∫øt n·ªëi th√†nh c√¥ng (ƒë√®n LED, ti·∫øng n√≥i, m√†n h√¨nh ho·∫∑c log tr√™n serial).
                    Sau ƒë√≥ b·∫°n c√≥ th·ªÉ r√∫t ngu·ªìn c·∫•p t·∫°m th·ªùi v√† d√πng thi·∫øt b·ªã b√¨nh th∆∞·ªùng.
                </li>
                <li>
                    Khi ƒë√£ ·ªïn ƒë·ªãnh, v√†o tab <strong data-lang="advanced_tab">Advanced</strong> ƒë·ªÉ ch·ªânh URL OTA,
                    MUSIC ho·∫∑c c√¥ng su·∫•t ph√°t Wi-Fi cho ph√π h·ª£p.
                </li>
            </ol>
            <div class="guide-highlight">
                <strong>M·∫πo nh·ªè:</strong> Lu√¥n ∆∞u ti√™n m·∫°ng 2.4&nbsp;GHz cho ESP32. N·∫øu router ph√°t c·∫£ 2.4G v√† 5G,
                h√£y ch·ªçn t√™n Wi-Fi c√≥ ƒëu√¥i <em>2G</em>, <em>2.4G</em> ho·∫∑c kh√¥ng ghi g√¨.
            </div>

            <div class="guide-section-title">S·ª± c·ªë th∆∞·ªùng g·∫∑p</div>
            <ul class="error-list">
                <li>Kh√¥ng th·∫•y t√™n Wi-Fi nh√† b·∫°n: ki·ªÉm tra router c√≥ b·∫≠t 2.4G v√† SSID kh√¥ng ·∫©n.</li>
                <li>Nh·∫≠p ƒë√∫ng m·∫≠t kh·∫©u nh∆∞ng kh√¥ng k·∫øt n·ªëi: th·ª≠ kh·ªüi ƒë·ªông l·∫°i router v√† thi·∫øt b·ªã r·ªìi c·∫•u h√¨nh l·∫°i.</li>
                <li>Thi·∫øt b·ªã hay r·ªõt m·∫°ng: gi·∫£m c√¥ng su·∫•t TX ho·∫∑c ƒë·ªïi v·ªã tr√≠ ƒë·∫∑t router cho g·∫ßn h∆°n.</li>
            </ul>

            <div class="help-links">
                C·∫ßn h·ªó tr·ª£ th√™m? Li√™n h·ªá C√îNG TY TNHH PRIMERA TECH LABS ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£.
            </div>

            <div class="guide-footer">
                ¬© C√îNG TY TNHH PRIMERA TECH LABS
            </div>
        </div>
    </div>

    <script>
        const button = document.getElementById('button');
        const error = document.getElementById('error');
        const ssid = document.getElementById('ssid');
        let support5G = false;

        const translations = {
            'vi-VN': {
                title: 'C·∫•u h√¨nh m·∫°ng',
                saved_wifi: 'Wi-Fi ƒë√£ l∆∞u',
                new_wifi: 'Wi-Fi m·ªõi',
                password: 'M·∫≠t kh·∫©u:',
                connect: 'K·∫øt n·ªëi',
                connecting: 'ƒêang k·∫øt n·ªëi...',
                select_wifi: 'Ch·ªçn Wi-Fi 2.4G t·ª´ danh s√°ch b√™n d∆∞·ªõi:',
                select_wifi_5g: 'Ch·ªçn Wi-Fi t·ª´ danh s√°ch b√™n d∆∞·ªõi:',
                scanning: 'ƒêang qu√©t...',
                wifi_tab: 'C·∫•u h√¨nh Wi-Fi',
                advanced_tab: 'T√πy ch·ªçn n√¢ng cao',
                weather_API_key: 'Kh√≥a API Th·ªùi ti·∫øt t√πy ch·ªânh:',
                weather_city: 'Th√†nh ph·ªë Th·ªùi ti·∫øt t√πy ch·ªânh:',
                music_url: 'ƒê·ªãa ch·ªâ MUSIC t√πy ch·ªânh:',
                ota_url: 'ƒê·ªãa ch·ªâ OTA t√πy ch·ªânh:',
                max_tx_power: 'C√¥ng su·∫•t ph√°t Wi-Fi t·ªëi ƒëa:',
                remember_bssid: 'Ghi nh·ªõ BSSID khi k·∫øt n·ªëi v·ªõi Wi-Fi',
                sleep_mode: 'B·∫≠t ch·∫ø ƒë·ªô ng·ªß',
                save: 'L∆∞u'
            },
            'en-US': {
                title: 'Network Configuration',
                saved_wifi: 'Saved Wi-Fi',
                new_wifi: 'New Wi-Fi',
                password: 'Password:',
                connect: 'Connect',
                connecting: 'Connecting...',
                select_wifi: 'Select a 2.4G Wi-Fi from the list below:',
                select_wifi_5g: 'Select a Wi-Fi from the list below:',
                scanning: 'Scanning...',
                wifi_tab: 'Wi-Fi Config',
                advanced_tab: 'Advanced',
                weather_API_key: 'Custom Weather API Key:',
                weather_city: 'Custom Weather City:',
                music_url: 'Custom MUSIC URL:',
                ota_url: 'Custom OTA URL:',
                max_tx_power: 'Wi-Fi Max TX Power:',
                remember_bssid: 'Remember BSSID when connecting to Wi-Fi',
                sleep_mode: 'Enable Sleep Mode',
                save: 'Save'
            }
        };

        const languageMap = {
            'vi': 'vi-VN', 'vi-VN': 'vi-VN',
            'en': 'en-US', 'en-US': 'en-US', 'en-GB': 'en-US', 'en-CA': 'en-US', 'en-AU': 'en-US'
        };

        function getSupportedLanguage(lang) {
            if (languageMap[lang]) return languageMap[lang];
            const mainLang = lang.split('-')[0];
            if (languageMap[mainLang]) return languageMap[mainLang];
            return 'vi-VN';
        }

        function changeLanguage() {
            const lang = document.getElementById('language').value;
            if (!translations[lang]) {
                document.getElementById('language').value = 'vi-VN';
                return changeLanguage();
            }
            document.title = translations[lang].title;
            document.querySelectorAll('[data-lang]').forEach(element => {
                const key = element.getAttribute('data-lang');
                if (translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });
            document.querySelectorAll('[data-lang-value]').forEach(element => {
                const key = element.getAttribute('data-lang-value');
                if (translations[lang][key]) {
                    element.value = translations[lang][key];
                }
            });
            const apList = document.getElementById('ap_list');
            if (apList.firstChild) {
                const selectText = support5G ? translations[lang].select_wifi_5g : translations[lang].select_wifi;
                apList.firstChild.textContent = selectText;
            }
            localStorage.setItem('preferred_language', lang);
        }

        function renderSavedList(data) {
            const savedListContainer = document.getElementById('saved_list_container');
            const savedList = document.getElementById('saved_list');
            savedList.innerHTML = '';
            data.forEach((s, index) => {
                const li = document.createElement('li');
                let html = `<span>${s}</span>`;
                if (index > 0) {
                    html += ` <span>
                        <button type="button" onclick="setDefaultItem(this, ${index})">‚¨ÜÔ∏è</button>
                        <button type="button" onclick="deleteItem(this, ${index})">‚ùå</button>
                    </span>`;
                } else {
                    html += ` <span><button type="button" onclick="deleteItem(this, ${index})">‚ùå</button></span>`;
                }
                li.innerHTML = html;
                savedList.appendChild(li);
            });
            savedListContainer.style.display = data.length > 0 ? 'block' : 'none';
        }

        function deleteItem(item, index) {
            item.disabled = true;
            fetch('/saved/delete?index=' + index)
                .then(response => response.json())
                .then(() => {
                    loadSavedList();
                });
        }

        function setDefaultItem(item, index) {
            item.disabled = true;
            fetch('/saved/set_default?index=' + index)
                .then(response => response.json())
                .then(() => {
                    loadSavedList();
                });
        }

        function loadSavedList() {
            fetch('/saved/list')
                .then(response => response.json())
                .then(data => {
                    renderSavedList(data);
                });
        }

        function loadAPList() {
            if (button.disabled) return;
            const lang = document.getElementById('language').value;
            const apList = document.getElementById('ap_list');
            const hasExistingAPs = apList.querySelector('a') !== null;
            if (!hasExistingAPs) {
                apList.innerHTML = '<p class="scanning">' + translations[lang].scanning + '</p>';
            }
            fetch('/scan')
                .then(response => response.json())
                .then(data => {
                    support5G = data.support_5g;
                    const selectText = support5G ? translations[lang].select_wifi_5g : translations[lang].select_wifi;
                    apList.innerHTML = '<p>' + selectText + '</p>';
                    data.aps.forEach(ap => {
                        const link = document.createElement('a');
                        link.href = '#';
                        link.textContent = ap.ssid + ' (' + ap.rssi + ' dBm)';
                        if (ap.authmode === 0) {
                            link.textContent += ' üåê';
                        } else {
                            link.textContent += ' üîí';
                        }
                        link.addEventListener('click', () => {
                            ssid.value = ap.ssid;
                        });
                        apList.appendChild(link);
                    });
                    setTimeout(loadAPList, 5000);
                })
                .catch(() => {
                    setTimeout(loadAPList, 5000);
                });
        }

        async function submitForm(event) {
            event.preventDefault();
            button.disabled = true;
            error.textContent = '';
            const loadingOverlay = document.getElementById('loadingOverlay');
            loadingOverlay.classList.add('show');
            const payload = {
                ssid: ssid.value,
                password: document.getElementById('password').value
            };
            try {
                const response = await fetch('/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                const data = await response.json();
                if (!data.success) {
                    throw new Error(data.error || 'Connection failed');
                }
                button.disabled = false;
                window.location.href = '/done.html';
            } catch (err) {
                loadingOverlay.classList.remove('show');
                error.textContent = err.message;
                button.disabled = false;
            }
        }

        async function submitAdvancedForm(event) {
            event.preventDefault();
            const advancedButton = document.getElementById('advanced_button');
            const advancedError = document.getElementById('advanced_error');
            advancedButton.disabled = true;
            advancedError.textContent = '';
            const config = {
                weather_api_key: document.getElementById('weather_api_key').value,
                weather_city: document.getElementById('weather_city').value,
                music_url: document.getElementById('music_url').value,
                ota_url: document.getElementById('ota_url').value,
                max_tx_power: parseInt(document.getElementById('max_tx_power').value),
                remember_bssid: document.getElementById('remember_bssid').checked,
                sleep_mode: document.getElementById('sleep_mode').checked
            };
            try {
                const response = await fetch('/advanced/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(config)
                });
                const data = await response.json();
                if (!data.success) {
                    throw new Error(data.error || 'Save failed');
                }
                advancedButton.disabled = false;
                showToast('Configuration saved');
            } catch (err) {
                advancedError.textContent = err.message;
                advancedButton.disabled = false;
            }
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName + '-tab').classList.add('active');
            document.querySelector(`.tab[onclick="switchTab('${tabName}')"]`).classList.add('active');
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        async function loadAdvancedConfig() {
            try {
                const response = await fetch('/advanced/config');
                const data = await response.json();
                if (data.weather_api_key) {
                    document.getElementById('weather_api_key').value = data.weather_api_key;
                }
                if (data.weather_city) {
                    document.getElementById('weather_city').value = data.weather_city;
                }
                if (data.music_url) {
                    document.getElementById('music_url').value = data.music_url;
                }
                if (data.ota_url) {
                    document.getElementById('ota_url').value = data.ota_url;
                }
                if (data.max_tx_power) {
                    document.getElementById('max_tx_power').value = data.max_tx_power;
                }
                if (data.remember_bssid !== undefined) {
                    document.getElementById('remember_bssid').checked = data.remember_bssid;
                }
                if (data.sleep_mode !== undefined) {
                    document.getElementById('sleep_mode').checked = data.sleep_mode;
                }
            } catch (e) {
            }
        }

        function clearWeatherApiKey() {
            document.getElementById('weather_api_key').value = '';
        }

        function clearWeatherCity() {
            document.getElementById('weather_city').value = '';
        }

        function clearMusicUrl() {
            document.getElementById('music_url').value = '';
        }

        function clearOtaUrl() {
            document.getElementById('ota_url').value = '';
        }

        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const langParam = urlParams.get('lang');
            const browserLang = navigator.language || navigator.userLanguage;
            const savedLang = langParam ||
                localStorage.getItem('preferred_language') ||
                getSupportedLanguage(browserLang);
            document.getElementById('language').value = savedLang;
            changeLanguage();
            loadSavedList();
            loadAPList();
            loadAdvancedConfig();
        });

        window.addEventListener('pageshow', (event) => {
            if (event.persisted) {
                loadSavedList();
            }
        });

        ssid.addEventListener('touchstart', () => {
            ssid.removeAttribute('readonly');
            ssid.focus();
        }, { once: true });
    </script>
</body>

</html>